<!doctype html>
<html lang="ar" dir="rtl">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <title>Ø¹Ø§ÙƒÙ - Ù…Ù†ÙŠÙˆ Ø£ÙˆÙ†Ù„Ø§ÙŠÙ† (Ø¨Ø±ÙŠÙ…ÙŠÙˆÙ…)</title>
  <meta name="description" content="Ø§Ø·Ù„Ø¨ Ù…Ù† Ø¬Ø²Ø§Ø±Ø© Ø¹Ø§ÙƒÙ - Ù„Ø­ÙˆÙ… Ø·Ø§Ø²Ø© ÙˆØ­ÙˆØ§ÙˆØ´ÙŠ ÙˆØ¹Ø±ÙˆØ¶ ÙŠÙˆÙ…ÙŠØ©">
  <meta property="og:title" content="Ù…Ù†ÙŠÙˆ Ø¹Ø§ÙƒÙ - Ø£ÙØ¶Ù„ Ù„Ø­ÙˆÙ… ÙˆØ­ÙˆØ§ÙˆØ´ÙŠ">
  <meta property="og:description" content="Ø§Ø·Ù„Ø¨ Ø£ÙˆÙ†Ù„Ø§ÙŠÙ† Ù…Ù† Ø¬Ø²Ø§Ø±Ø© Ø¹Ø§ÙƒÙ â€“ Ø£Ø¬ÙˆØ¯ Ø§Ù„Ù„Ø­ÙˆÙ… ÙˆØ§Ù„Ø¹Ø±ÙˆØ¶ Ø§Ù„ÙŠÙˆÙ…ÙŠØ©">
  <meta property="og:image" content="logo.png">
  <style>
    :root{
      --bg1: #0b0b0b;
      --bg2: #141212;
      --accent: #e11b1b; /* Ù…Ù† Ù„ÙˆØ§Ù† Ø§Ù„Ù„ÙˆØ¬Ùˆ */
      --muted: #bfc6c6;
      --glass: rgba(255,255,255,0.03);
      --white: #ffffff;
      --success: #2ecc71;
    }
    *{box-sizing:border-box}
    body{margin:0;font-family:Tahoma, Arial, sans-serif;background:linear-gradient(180deg,var(--bg1),var(--bg2));color:var(--muted);}
    header{position:sticky;top:0;z-index:120;background:linear-gradient(90deg, rgba(0,0,0,0.35), rgba(0,0,0,0.18));backdrop-filter:blur(4px);display:flex;align-items:center;gap:12px;padding:12px 16px}
    .logo{width:84px;height:84px;border-radius:14px;overflow:hidden;border:3px solid rgba(255,255,255,0.03)}
    .logo img{width:100%;height:100%;object-fit:cover}
    .brand{display:flex;flex-direction:column}
    .brand h1{margin:0;color:var(--white);font-size:18px}
    .brand p{margin:2px 0 0;color:var(--muted);font-size:12px}

    /* offers marquee */
    .offers{flex:1;margin-left:12px}
    .marquee{overflow:hidden;white-space:nowrap}
    .marquee .track{display:inline-block;padding-left:100%;animation:scroll 18s linear infinite}
    @keyframes scroll{0%{transform:translateX(0%)}100%{transform:translateX(-100%)}}
    .marquee .badge{display:inline-block;background:linear-gradient(90deg,var(--accent),#ff6b6b);padding:6px 12px;border-radius:999px;color:white;margin-left:12px;font-weight:700}

    .controls{display:flex;gap:8px;align-items:center}
    .search{padding:8px 12px;border-radius:10px;border:1px solid rgba(255,255,255,0.04);background:transparent;color:var(--muted);min-width:220px}
    .icon-btn{background:transparent;border:1px solid rgba(255,255,255,0.04);padding:8px;border-radius:10px;color:var(--muted);cursor:pointer}

    .wrap{max-width:1100px;margin:14px auto;padding:8px}
    .grid{display:grid;grid-template-columns:1fr 360px;gap:18px}
    @media(max-width:980px){.grid{grid-template-columns:1fr}}

    /* skeleton loader */
    .skeleton{display:grid;grid-template-columns:repeat(2,1fr);gap:12px}
    .skeleton .box{height:120px;border-radius:12px;background:linear-gradient(90deg,#1a1a1a,#111,#1a1a1a);animation:pulse 1.2s infinite}
    @keyframes pulse{0%{opacity:0.6}50%{opacity:1}100%{opacity:0.6}}

    /* items */
    .card{background:rgba(255,255,255,0.02);padding:12px;border-radius:12px}
    .menu{display:grid;grid-template-columns:repeat(2,1fr);gap:12px}
    @media(max-width:640px){.menu{grid-template-columns:1fr}}
    .item{display:flex;gap:10px;align-items:center;background:linear-gradient(180deg, rgba(255,255,255,0.01), transparent);padding:10px;border-radius:10px}
    .thumb{width:96px;height:72px;border-radius:8px;overflow:hidden;background:#111;flex-shrink:0}
    .thumb img{width:100%;height:100%;object-fit:cover;display:block}
    .info{flex:1;text-align:right}
    .info h3{margin:0;color:var(--white);font-size:15px}
    .info p{margin:6px 0 0;font-size:13px;color:var(--muted)}
    .price{margin-top:8px;color:var(--accent);font-weight:800}
    .add{background:var(--accent);color:white;border:none;padding:8px 10px;border-radius:8px;cursor:pointer}

    /* mini cart in header */
    .mini-cart{display:inline-flex;align-items:center;gap:8px;padding:6px 10px;border-radius:12px;background:rgba(0,0,0,0.35);border:1px solid rgba(255,255,255,0.03);cursor:pointer}
    .mini-cart .count{background:#111;padding:6px 8px;border-radius:999px;border:1px solid rgba(255,255,255,0.03);}
    .shake{animation:shake .5s}
    @keyframes shake{0%{transform:translateX(0)}25%{transform:translateX(-6px)}50%{transform:translateX(6px)}75%{transform:translateX(-4px)}100%{transform:translateX(0)}}

    /* cart slide panel */
    .cart-panel{position:fixed;right:-420px;top:0;width:380px;height:100%;background:linear-gradient(180deg,#0c0c0c,#111);box-shadow:-20px 0 40px rgba(0,0,0,0.6);padding:18px;transition:right .35s;z-index:200}
    .cart-panel.open{right:0}
    .cart-list{max-height:60vh;overflow:auto;margin-top:12px}
    .cart-item{display:flex;justify-content:space-between;align-items:center;padding:8px;border-radius:8px;background:rgba(255,255,255,0.01);margin-bottom:8px}

    /* modal preview */
    .modal{position:fixed;inset:0;display:none;align-items:center;justify-content:center;background:rgba(0,0,0,0.6);z-index:300}
    .modal.open{display:flex}
    .modal .box{background:#0f0f0f;padding:12px;border-radius:12px;max-width:600px;width:90%}

    /* small badges / effects */
    .pulse{animation:pulse 1.6s infinite}
    .blink{animation:blink 1.2s infinite}
    @keyframes blink{0%{opacity:1}50%{opacity:0.2}100%{opacity:1}}

    .countdown{font-weight:800;color:var(--accent);}

    footer{margin-top:18px;text-align:center;color:#8d9999}
  </style>
</head>
<body>
  <header>
    <div class="logo"><img src="img/ØµÙˆØ±Ø© ÙˆØ§ØªØ³Ø§Ø¨ Ø¨ØªØ§Ø±ÙŠØ® 1447-03-18 ÙÙŠ 04.52.23_bb7a8181.jpg" alt="Ù„ÙˆØ¬Ùˆ"></div>
    <div class="brand">
      <h1>Ø¹Ø§ÙƒÙ - Ø¬Ø²Ø§Ø±Ø© Ùˆ Ø­ÙˆØ§ÙˆØ´ÙŠ</h1>
      <p>Ø£Ø·ÙŠØ¨ Ø£Ù†ÙˆØ§Ø¹ Ø§Ù„Ù„Ø­ÙˆÙ… ÙˆØ§Ù„Ø­ÙˆØ§ÙˆØ´ÙŠ â€” Ø§Ø·Ù„Ø¨ Ø¯Ù„ÙˆÙ‚ØªÙŠ</p>
    </div>

    <div class="offers">
      <div class="marquee" aria-hidden="true">
        <div class="track" id="offersTrack"></div>
      </div>
    </div>

    <div class="controls">
      <input class="search" id="search" placeholder="Ø§Ø¨Ø­Ø« Ø¹Ù† ØµÙ†Ù Ø£Ùˆ ÙƒÙ„Ù…Ø©..." />
      <button class="icon-btn" id="themeBtn" title="Ø§Ù„ÙˆØ¶Ø¹">ğŸŒ™</button>
      <div class="mini-cart" id="miniCartBtn" title="Ø§ÙØªØ­ Ø§Ù„Ø¹Ø±Ø¨Ø©"><span id="cartTotal">0 Ø¬.Ù…</span><span class="count" id="cartCount">0</span></div>
    </div>
  </header>

  <div class="wrap">
    <div class="card">
      <div id="skeleton" class="skeleton" aria-hidden>
        <div class="box"></div><div class="box"></div><div class="box"></div><div class="box"></div>
      </div>

      <!-- ITEMS: ØºÙŠÙ‘Ø± Ø§Ù„ØµÙˆØ± ÙˆØ§Ù„Ù…Ø­ØªÙˆÙ‰ Ù‡Ù†Ø§ Ù…Ø¨Ø§Ø´Ø±Ø© ÙÙŠ HTML ÙƒÙ…Ø§ ØªØ­Ø¨ -->
      <div class="menu" id="menu">
        <div class="item" data-id="1" data-price="85" data-name="Ø­ÙˆØ§ÙˆØ´ÙŠ Ù„Ø­Ù…">
          <div class="thumb"><img src="img/omar_resized_1700x970 (1).jpg" alt="Ø­ÙˆØ§ÙˆØ´ÙŠ"></div>
          <div class="info"><h3>Ø­ÙˆØ§ÙˆØ´ÙŠ Ù„Ø­Ù…</h3><p>Ø­ÙˆØ§ÙˆØ´ÙŠ Ø¹Ø§Ù„ÙØ­Ù… 250Ø¬Ù…</p><div class="price">85 Ø¬.Ù…</div></div>
          <div><button class="add" data-id="1">Ø£Ø¶Ù</button></div>
        </div>

        <div class="item" data-id="2" data-price="110" data-name="Ø¨Ø±Ø¬Ø± Ø¯ÙˆØ¨Ù„">
          <div class="thumb"><img src="img/ØµÙˆØ±Ø© ÙˆØ§ØªØ³Ø§Ø¨ Ø¨ØªØ§Ø±ÙŠØ® 1447-03-18 ÙÙŠ 04.52.23_bb7a8181.jpg" alt="Ø¨Ø±Ø¬Ø±"></div>
          <div class="info"><h3>Ø¨Ø±Ø¬Ø± Ø¯ÙˆØ¨Ù„</h3><p>Ù‚Ø·Ø¹ØªÙŠÙ† Ù„Ø­Ù… Ù…Ø¹ Ø¬Ø¨Ù†Ø©</p><div class="price">110 Ø¬.Ù…</div></div>
          <div><button class="add" data-id="2">Ø£Ø¶Ù</button></div>
        </div>

        <div class="item" data-id="3" data-price="95" data-name="Ù†ØµÙ ÙØ±Ø®Ø© Ù…Ø´ÙˆÙŠØ©">
          <div class="thumb"><img src="img/ØµÙˆØ±Ø© ÙˆØ§ØªØ³Ø§Ø¨ Ø¨ØªØ§Ø±ÙŠØ® 1447-03-18 ÙÙŠ 04.52.23_bb7a8181.jpg" alt="ÙØ±Ø®Ø©"></div>
          <div class="info"><h3>Ù†ØµÙ ÙØ±Ø®Ø© Ù…Ø´ÙˆÙŠØ©</h3><p>Ù†ØµÙ ÙØ±Ø®Ø© Ù…Ø¹ Ø³Ù„Ø·Ø©</p><div class="price">95 Ø¬.Ù…</div></div>
          <div><button class="add" data-id="3">Ø£Ø¶Ù</button></div>
        </div>

        <div class="item" data-id="4" data-price="220" data-name="ÙƒØ¨Ø§Ø¨ Ø£Ø­Ù…Ø±">
          <div class="thumb"><img src="img/ØµÙˆØ±Ø© ÙˆØ§ØªØ³Ø§Ø¨ Ø¨ØªØ§Ø±ÙŠØ® 1447-03-18 ÙÙŠ 04.52.23_bb7a8181.jpg" alt="ÙƒØ¨Ø§Ø¨"></div>
          <div class="info"><h3>ÙƒØ¨Ø§Ø¨ Ø£Ø­Ù…Ø±</h3><p>ÙƒØ¨Ø§Ø¨ Ø·Ø§Ø²Ø© Ù…Ø´ÙˆÙŠ</p><div class="price">220 Ø¬.Ù…</div></div>
          <div><button class="add" data-id="4">Ø£Ø¶Ù</button></div>
        </div>
      </div>
    </div>

    <aside>
      <div class="card">
        <h3>ØªÙˆØ§ØµÙ„ Ø³Ø±ÙŠØ¹</h3>
        <p class="small-muted">Ø£Ø¶Ù Ø§Ø³Ù…Ùƒ ÙˆØ±Ù‚Ù…Ùƒ ÙˆØ³ÙŠØ¸Ù‡Ø± ÙÙŠ Ø±Ø³Ø§Ù„Ø© Ø§Ù„Ø·Ù„Ø¨.</p>
        <input id="custName" class="note-input" placeholder="Ø§Ø³Ù…Ùƒ (Ø§Ø®ØªÙŠØ§Ø±ÙŠ)" />
        <input id="custPhone" class="note-input" placeholder="Ø±Ù‚Ù… Ø§Ù„ØªÙ„ÙŠÙÙˆÙ† (Ø§Ø®ØªÙŠØ§Ø±ÙŠ)" />
        <textarea id="custNote" class="note-input" placeholder="Ù…Ù„Ø§Ø­Ø¸Ø§Øª Ø¹Ø§Ù…Ø©" rows="3"></textarea>
        <div style="display:flex;gap:8px;margin-top:8px;flex-wrap:wrap">
          <button class="add" id="checkoutBtn">Ø§Ø·Ù„Ø¨ Ø¹Ø¨Ø± ÙˆØ§ØªØ³Ø§Ø¨</button>
          <button class="icon-btn" id="shareBtn">Ù…Ø´Ø§Ø±ÙƒØ©</button>
          <a class="icon-btn" id="callBtn" href="tel:01030759462">Ø§ØªØµÙ„</a>
          <a class="icon-btn" id="mapBtn" href="https://maps.google.com?q=Ø¬Ø²Ø§Ø±Ø©+Ø¹Ø§ÙƒÙ" target="_blank">Ø®Ø±Ø§Ø¦Ø·</a>
        </div>

        <div style="margin-top:12px;text-align:right">
          <div>Ø§Ù„Ø¥Ø¬Ù…Ø§Ù„ÙŠ: <strong id="totalPrice">0 Ø¬.Ù…</strong></div>
          <div id="freeShippingMsg" class="small-muted" style="margin-top:8px"></div>
          <div style="margin-top:8px">ÙˆÙ‚Øª Ø§Ù„ØªÙˆØµÙŠÙ„ Ø§Ù„Ù…ØªÙˆÙ‚Ø¹: <span id="eta">30 Ø¯Ù‚ÙŠÙ‚Ø©</span></div>
          <div style="margin-top:8px">Ù…Ø¹Ø¯Ù„ Ø§Ù„ØªÙ‚ÙŠÙŠÙ…: <span id="avgRate">0</span> â­</div>
        </div>
      </div>
    </aside>
  </div>

  <!-- cart panel -->
  <div class="cart-panel" id="cartPanel">
    <h3>Ø¹Ø±Ø¨Ø© Ø§Ù„Ø·Ù„Ø¨</h3>
    <div class="cart-list" id="cartList"><div class="small-muted">Ø§Ù„Ø¹Ø±Ø¨Ø© ÙØ§Ø±ØºØ©</div></div>
    <div style="margin-top:8px;display:flex;justify-content:space-between;align-items:center"><div class="small-muted">Ø§Ù„Ù…Ø¬Ù…ÙˆØ¹</div><div id="cartSum" style="font-weight:900;color:var(--accent)">0 Ø¬.Ù…</div></div>
    <div style="margin-top:12px;display:flex;gap:8px"><button class="add" id="cartCheckout">Ø§Ø·Ù„Ø¨ Ø§Ù„Ø¢Ù†</button><button class="icon-btn" id="clearCart">ØªÙØ±ÙŠØº</button></div>
    <div style="margin-top:10px" id="upsellArea"></div>
  </div>

  <!-- modal preview -->
  <div class="modal" id="previewModal"><div class="box" id="modalBox"></div></div>

  <!-- toast + countdown -->
  <div id="toast" style="position:fixed;bottom:20px;right:20px;background:var(--accent);color:#fff;padding:8px 12px;border-radius:8px;opacity:0;transition:opacity .25s;z-index:400">ØªÙ…Øª Ø§Ù„Ø¥Ø¶Ø§ÙØ© Ù„Ù„Ø¹Ø±Ø¨Ø©</div>

  <script>
    // ========= settings ==========
    const PHONE = '201030759462';
    const LOCAL_PHONE = '01030759462';
    const CURRENCY = 'Ø¬.Ù…';
    const DISCOUNT_PERCENT = 10; // ÙŠØµÙ„ Ø­ØªÙ‰ 10%
    const FREE_SHIPPING_THRESHOLD = 300; // Ø¬.Ù…

    // offers messages (ØªÙ‚Ø¯Ø± ØªØ¹Ø¯Ù„ Ø§Ù„Ù†ØµÙˆØµ Ù‡Ù†Ø§)
    const OFFERS = [
      'Ø¹Ø±Ø¶ Ø§Ù„ÙŠÙˆÙ…: Ø®ØµÙ… Ø­ØªÙ‰ 10% Ø¹Ù„Ù‰ Ø§Ù„Ø·Ù„Ø¨Ø§Øª ÙÙˆÙ‚ 500 Ø¬.Ù…!',
      'Ø¬Ø±Ø¨ Ø­ÙˆØ§ÙˆØ´ÙŠ Ø¹Ø§ÙƒÙ - Ø·Ø¹Ù…Ù‡ ÙŠØ®Ù„ÙŠÙƒ ØªØ±Ø¬Ø¹ ØªØ§Ù†ÙŠ ğŸ”¥',
      'ØªÙˆØµÙŠÙ„ Ø³Ø±ÙŠØ¹ Ø®Ù„Ø§Ù„ 30 Ø¯Ù‚ÙŠÙ‚Ø© ØªÙ‚Ø±ÙŠØ¨Ø§Ù‹' 
    ];

    // ====== state ======
    let cart = JSON.parse(localStorage.getItem('akaf_cart')||'[]');
    let ratings = JSON.parse(localStorage.getItem('akaf_ratings')||'{}');
    let lastCart = JSON.parse(localStorage.getItem('akaf_last')||'[]');

    // ========== init UI ==========
    const menu = document.getElementById('menu');
    const itemsDOM = Array.from(menu.querySelectorAll('.item'));
    const ITEMS = itemsDOM.map(el=>({
      id: Number(el.dataset.id),
      name: el.dataset.name || el.querySelector('h3')?.textContent.trim(),
      price: Number(el.dataset.price || 0),
      img: el.querySelector('img')?.src || '',
      desc: el.querySelector('p')?.textContent || ''
    }));

    // build offers marquee
    const offersTrack = document.getElementById('offersTrack');
    offersTrack.innerHTML = OFFERS.map(o=>`<span class='badge'>${o}</span>`).join(' ');

    // show skeleton then content
    const skeleton = document.getElementById('skeleton');
    setTimeout(()=>{ skeleton.style.display='none'; menu.style.opacity=1; }, 800);

    // helper
    function formatPrice(n){ return n.toLocaleString('ar-EG') + ' ' + CURRENCY }

    // render items (buttons already inline in HTML, attach events)
    document.querySelectorAll('.add').forEach(btn=>{ btn.addEventListener('click', ()=>{ const id = Number(btn.dataset.id || btn.closest('.item')?.dataset.id); addToCartById(id); playPop(); }); });

    // preview modal on image click
    itemsDOM.forEach(el=>{ const img = el.querySelector('img'); if(img){ img.style.cursor='pointer'; img.addEventListener('click', ()=>{ openPreview(el); }); } });

    function openPreview(el){ const id = Number(el.dataset.id); const it = ITEMS.find(i=>i.id===id); const box = document.getElementById('modalBox'); box.innerHTML = `
      <div style='display:flex;gap:12px;align-items:center'>
        <div style='flex:0 0 200px'><img src='${it.img}' style='width:200px;height:140px;object-fit:cover;border-radius:8px'/></div>
        <div style='text-align:right'>
          <h3 style='margin:0;color:var(--white)'>${it.name}</h3>
          <p style='color:var(--muted)'>${it.desc}</p>
          <div style='margin-top:8px;font-weight:800;color:var(--accent)'>${formatPrice(it.price)}</div>
          <div style='margin-top:8px'><button class='add' id='modalAdd'>Ø£Ø¶Ù Ù„Ù„Ø¹Ø±Ø¨Ø©</button></div>
        </div>
      </div>`;
      document.getElementById('previewModal').classList.add('open');
      document.getElementById('modalAdd').addEventListener('click', ()=>{ addToCartById(it.id); closePreview(); });
    }
    document.getElementById('previewModal').addEventListener('click', (e)=>{ if(e.target.id==='previewModal') closePreview(); });
    function closePreview(){ document.getElementById('previewModal').classList.remove('open'); }

    // add to cart
    function addToCartById(id){ const item = ITEMS.find(i=>i.id===id); if(!item) return; const found = cart.find(c=>c.id===id); if(found) found.qty++; else cart.push({id:id,qty:1}); saveState(); renderCart(); showToast('ØªÙ…Øª Ø§Ù„Ø¥Ø¶Ø§ÙØ©'); animateMiniCart(); // show upsell
      showUpsell(item.id);
    }

    function saveState(){ localStorage.setItem('akaf_cart', JSON.stringify(cart)); localStorage.setItem('akaf_ratings', JSON.stringify(ratings)); }

    function renderCart(){ const list = document.getElementById('cartList'); list.innerHTML=''; if(cart.length===0){ list.innerHTML='<div class="small-muted">Ø§Ù„Ø¹Ø±Ø¨Ø© ÙØ§Ø±ØºØ©</div>'; document.getElementById('cartSum').textContent = '0 ' + CURRENCY; document.getElementById('cartCount').textContent='0'; document.getElementById('cartTotal').textContent='0 ' + CURRENCY; return }
      cart.forEach((ci,idx)=>{ const it = ITEMS.find(i=>i.id===ci.id); const el = document.createElement('div'); el.className='cart-item'; el.innerHTML = `
        <div style='text-align:right'>
          <strong style='color:var(--white)'>${it.name}</strong>
          <div class='small-muted'>${ci.qty} x ${formatPrice(it.price)}</div>
        </div>
        <div style='display:flex;flex-direction:column;gap:6px;align-items:flex-end'>
          <div style='font-weight:800;color:var(--accent)'>${formatPrice(it.price*ci.qty)}</div>
          <div style='display:flex;gap:6px'>
            <button class='icon-btn' data-idx='${idx}' data-act='inc'>+</button>
            <button class='icon-btn' data-idx='${idx}' data-act='dec'>-</button>
            <button class='icon-btn' data-idx='${idx}' data-act='rem'>Ø­Ø°Ù</button>
          </div>
        </div>`; list.appendChild(el); });
      // attach
      list.querySelectorAll('button').forEach(b=> b.addEventListener('click', ()=>{ const idx=Number(b.dataset.idx); const act=b.dataset.act; if(act==='inc') changeQty(idx,1); if(act==='dec') changeQty(idx,-1); if(act==='rem') removeItem(idx); }));
      updateTotals();
    }

    function changeQty(idx,delta){ cart[idx].qty += delta; if(cart[idx].qty<=0) cart.splice(idx,1); saveState(); renderCart(); playTrash(); }
    function removeItem(idx){ cart.splice(idx,1); saveState(); renderCart(); playTrash(); }

    function updateTotals(){ const subtotal = cart.reduce((s,i)=> s + (ITEMS.find(x=>x.id===i.id).price * i.qty), 0); const discount = subtotal >= 500 ? Math.round(subtotal * DISCOUNT_PERCENT/100) : 0; const total = subtotal - discount; document.getElementById('cartSum').textContent = formatPrice(total); document.getElementById('totalPrice').textContent = formatPrice(total); document.getElementById('cartCount').textContent = cart.reduce((s,i)=>s+i.qty,0); document.getElementById('cartTotal').textContent = formatPrice(total);
      // free shipping hint
      const freeMsg = document.getElementById('freeShippingMsg'); if(subtotal < FREE_SHIPPING_THRESHOLD){ const need = FREE_SHIPPING_THRESHOLD - subtotal; freeMsg.textContent = `Ø£Ø¶Ù ${need.toLocaleString('ar-EG')} ${CURRENCY} Ùˆ Ø®Ø° ØªÙˆØµÙŠÙ„ Ù…Ø¬Ø§Ù†ÙŠ`; } else { freeMsg.textContent = 'Ø£Ù†Øª Ø­ØµÙ„Øª Ø¹Ù„Ù‰ ØªÙˆØµÙŠÙ„ Ù…Ø¬Ø§Ù†ÙŠ ğŸ‰'; }
      // discount info
      const upsell = document.getElementById('upsellArea'); upsell.innerHTML = discount>0 ? `<div style='color:var(--success)'>ØªÙ… ØªØ·Ø¨ÙŠÙ‚ Ø®ØµÙ… ${DISCOUNT_PERCENT}% Ø¨Ù‚ÙŠÙ…Ø© ${formatPrice(discount)}</div>` : '';
    }

    // checkout via WhatsApp
    document.getElementById('cartCheckout').addEventListener('click', ()=>{ checkout(); });
    document.getElementById('checkoutBtn').addEventListener('click', ()=>{ checkout(); });
    function checkout(){ if(cart.length===0){ alert('Ø§Ù„Ø¹Ø±Ø¨Ø© ÙØ§Ø±ØºØ©'); return } const name = document.getElementById('custName').value || 'Ø²Ø¨ÙˆÙ†'; const phone = document.getElementById('custPhone').value || LOCAL_PHONE; const note = document.getElementById('custNote').value || ''; let text = `Ø·Ù„Ø¨ Ø¬Ø¯ÙŠØ¯ Ù…Ù† ${name} - Ù…Ù†ÙŠÙˆ Ø¹Ø§ÙƒÙ\n`;
      cart.forEach(i=>{ const it = ITEMS.find(x=>x.id==i.id); text += `- ${it.name} x ${i.qty} = ${it.price*i.qty} ${CURRENCY}\n`; });
      const subtotal = cart.reduce((s,i)=> s + (ITEMS.find(x=>x.id===i.id).price * i.qty), 0); const discount = subtotal >= 500 ? Math.round(subtotal * DISCOUNT_PERCENT/100) : 0; const total = subtotal - discount; text += `\nØ§Ù„Ù…Ø¬Ù…ÙˆØ¹: ${total} ${CURRENCY}`; if(discount>0) text += ` (Ø´Ù…Ù„ Ø®ØµÙ… ${DISCOUNT_PERCENT}% = ${discount} ${CURRENCY})`;
      if(note) text += `\nÙ…Ù„Ø§Ø­Ø¸Ø§Øª: ${note}`;
      text += `\nØ±Ù‚Ù… Ø§Ù„Ø¹Ù…ÙŠÙ„: ${phone}`;
      const url = `https://wa.me/${PHONE}?text=${encodeURIComponent(text)}`; window.open(url,'_blank'); // after sending clear cart
      lastCart = JSON.parse(JSON.stringify(cart)); localStorage.setItem('akaf_last', JSON.stringify(lastCart)); cart = []; saveState(); renderCart(); showToast('ØªÙ… Ø¥Ø±Ø³Ø§Ù„ Ø§Ù„Ø·Ù„Ø¨');
    }

    document.getElementById('clearCart').addEventListener('click', ()=>{ if(confirm('Ù‡Ù„ ØªØ±ÙŠØ¯ ØªÙØ±ÙŠØº Ø§Ù„Ø¹Ø±Ø¨Ø©ØŸ')){ lastCart = JSON.parse(JSON.stringify(cart)); localStorage.setItem('akaf_last', JSON.stringify(lastCart)); cart=[]; saveState(); renderCart(); showToast('ØªÙ… Ø§Ù„ØªÙØ±ÙŠØº'); showRestoreBtn(); } });

    function showRestoreBtn(){ const panel = document.getElementById('cartPanel'); if(panel.querySelector('#restoreBtn')) return; const btn = document.createElement('button'); btn.className='add'; btn.id='restoreBtn'; btn.textContent='Ø±Ø¬Ø¹ Ø¢Ø®Ø± Ø·Ù„Ø¨'; btn.style.marginTop='8px'; btn.addEventListener('click', ()=>{ cart = JSON.parse(localStorage.getItem('akaf_last')||'[]'); saveState(); renderCart(); btn.remove(); }); panel.appendChild(btn); }

    function showUpsell(productId){ const area = document.getElementById('upsellArea'); // simple static suggestion
      const suggestion = ITEMS.find(i=>i.id!==productId); if(suggestion){ area.innerHTML += `<div style='margin-top:8px;background:rgba(255,255,255,0.02);padding:8px;border-radius:8px'>Ø¬Ø±Ù‘Ø¨ ÙƒÙ…Ø§Ù†: <strong style='color:var(--white)'>${suggestion.name}</strong> â€” <button class='add' onclick='addToCartById(${suggestion.id})'>Ø£Ø¶Ù</button></div>`; }
    }

    // toast
    const toast = document.getElementById('toast'); function showToast(txt='ØªÙ…Øª Ø§Ù„Ø¥Ø¶Ø§ÙØ©'){ toast.textContent = txt; toast.style.opacity=1; setTimeout(()=> toast.style.opacity=0,2000); }

    // sounds
    function playPop(){ try{ const ctx=new (window.AudioContext||window.webkitAudioContext)(); const o=ctx.createOscillator(); const g=ctx.createGain(); o.type='sine'; o.frequency.value=880; g.gain.value=0.01; o.connect(g); g.connect(ctx.destination); o.start(); setTimeout(()=>{o.stop();ctx.close()},60);}catch(e){} }
    function playTrash(){ try{ const ctx=new (window.AudioContext||window.webkitAudioContext)(); const o=ctx.createOscillator(); const g=ctx.createGain(); o.type='square'; o.frequency.value=220; g.gain.value=0.01; o.connect(g); g.connect(ctx.destination); o.start(); setTimeout(()=>{o.stop();ctx.close()},80);}catch(e){} }

    // mini cart animation
    function animateMiniCart(){ const el = document.getElementById('miniCartBtn'); el.classList.add('shake'); setTimeout(()=> el.classList.remove('shake'),500); }

    // open cart panel
    const cartPanel = document.getElementById('cartPanel'); document.getElementById('miniCartBtn').addEventListener('click', ()=>{ cartPanel.classList.toggle('open'); });

    // render start
    renderCart();

    // preview: already handled

    // theme: auto night after 7pm
    (function initTheme(){ const h = new Date().getHours(); if(h>=19 || window.matchMedia('(prefers-color-scheme: dark)').matches) document.documentElement.style.setProperty('--bg1','#050505'); document.getElementById('themeBtn').addEventListener('click', ()=>{ document.body.classList.toggle('light-mode'); }); })();

    // countdown example for offer (ØªØ¹Ø¯ÙŠÙ„ ÙˆÙ‚Øª Ø§Ù„Ø¹Ø±Ø¶ Ù‡Ù†Ø§)
    (function initCountdown(){ const end = Date.now() + 1000*60*60*6; // 6 Ø³Ø§Ø¹Ø§Øª Ù…Ù† Ø§Ù„Ø¢Ù† ÙƒÙ…Ø«Ø§Ù„
      const el = document.createElement('div'); el.style.cssText='position:absolute;left:16px;top:10px;color:var(--accent);font-weight:800'; document.body.appendChild(el);
      setInterval(()=>{ const diff = end - Date.now(); if(diff<=0){ el.textContent='Ø§Ù†ØªÙ‡Ù‰ Ø§Ù„Ø¹Ø±Ø¶'; } else { const hh = Math.floor(diff/3600000); const mm = Math.floor((diff%3600000)/60000); el.textContent=`Ø¹Ø±Ø¶ ÙŠÙ†ØªØªÙ‡ÙŠ Ø®Ù„Ø§Ù„ ${hh}Ø³ ${mm}Ø¯ - Ø®ØµÙ… Ø­ØªÙ‰ ${DISCOUNT_PERCENT}%`; } },1000);
    })();

    // social message (fake live purchases)
    (function socialPulse(){ const el = document.createElement('div'); el.style.cssText='position:fixed;bottom:20px;left:20px;background:rgba(0,0,0,0.6);color:#fff;padding:8px;border-radius:8px;z-index:500'; document.body.appendChild(el);
      const messages = ['5 Ø£Ø´Ø®Ø§Øµ Ø§Ø´ØªØ±ÙˆØ§ Ø±ÙŠØ´ Ø¶Ø§Ù†ÙŠ ÙÙŠ Ø¢Ø®Ø± Ø³Ø§Ø¹Ø©','3 Ø¹Ù…Ù„Ø§Ø¡ Ø§Ø´ØªØ±ÙˆØ§ Ø­ÙˆØ§ÙˆØ´ÙŠ Ø§Ù„Ø¢Ù†','Ø¹Ø±Ø¶ Ø§Ù„ÙŠÙˆÙ… ÙŠØ¬Ø°Ø¨ Ø§Ù„Ù…Ø´ØªØ±ÙŠÙ†!']; let idx=0; setInterval(()=>{ el.textContent = messages[idx++%messages.length]; el.style.opacity=1; setTimeout(()=> el.style.opacity=0.5,4000); },5000);
    })();

    // swipe gestures (mobile) Ù„ÙØªØ­/ØºÙ„Ù‚ Ø§Ù„Ø¹Ø±Ø¨Ø©
    (function swipeGestures(){ let startX=0; document.addEventListener('touchstart', e=> startX = e.changedTouches[0].clientX); document.addEventListener('touchend', e=>{ const dx = e.changedTouches[0].clientX - startX; if(dx>80) cartPanel.classList.add('open'); if(dx<-80) cartPanel.classList.remove('open'); }); })();

    // share
    document.getElementById('shareBtn').addEventListener('click', ()=>{ const txt = ITEMS.map(i=> i.name + ' - ' + i.price + ' ' + CURRENCY).join('\n'); if(navigator.share){ navigator.share({title:'Ù…Ù†ÙŠÙˆ Ø¹Ø§ÙƒÙ', text: txt}).catch(()=>{}); } else { navigator.clipboard.writeText(txt); alert('ØªÙ… Ù†Ø³Ø® Ø§Ù„Ù…Ù†ÙŠÙˆØŒ Ø§Ù„ØµÙ‚Ù‡ ÙÙŠ Ø§ÙŠ Ù…ÙƒØ§Ù† Ù„Ù„Ù…Ø´Ø§Ø±ÙƒØ©'); } });

    // restore last cart on load (if any)
    (function restoreLast(){ const last = JSON.parse(localStorage.getItem('akaf_last')||'[]'); if(last && last.length && !cart.length){ /* keep empty until user asks */ } })();

    // allow editing images/content by HTML: you can ØªØºÙŠÙŠØ± src ÙÙŠ Ø¹Ù†Ø§ØµØ± .thumb img Ù…Ø¨Ø§Ø´Ø±Ø© Ø¯Ø§Ø®Ù„ Ø§Ù„Ù€ HTML ÙÙˆÙ‚

  </script>
  <footer>Ù†Ø³Ø®Ø© Ø¨Ø±ÙŠÙ…ÙˆÙ… Ù…Ù‡ÙŠÙ‘Ø£Ø© Ù„Ù„Ø¹Ø±Ø¶ â€” Ø¹Ø¯Ù‘Ù„ Ø§Ù„ØµÙˆØ± Ù…Ø¨Ø§Ø´Ø±Ø© ÙÙŠ ÙˆØ³Ù… &lt;img src="..."&gt; Ù„ÙƒÙ„ ØµÙ†Ù Ø¯Ø§Ø®Ù„ Ø§Ù„ÙƒÙˆØ¯</footer>
</body>
</html>